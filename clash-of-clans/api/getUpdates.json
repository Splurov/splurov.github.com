{"clash_of_clans":{"code":{"html":"<!DOCTYPE HTML> <html lang=\"en\"> <head> <meta charset=\"UTF-8\"/> <style>html,body{background:#fefefe;color:#222}body{font-family:'PT Sans',Arial,sans-serif;font-size:18px;line-height:1.5;margin:20px 40px}a{white-space:nowrap}a:link{color:#4100f1}a:link,a:visited{text-decoration:none}a:visited{color:#63008c}a:hover,a:active{text-decoration:underline}h1{font-size:28px;margin:0 0 12px}h2{font-size:22px;margin:18px 0 4px}p{margin:0 0 12px}.content{min-width:260px;max-width:520px}.photo{margin:8px 0 20px 20px;float:right;border-radius:10px}@media all and (max-width:560px){.photo{float:none;display:block;margin:0 auto 20px}}a.title{color:#222;text-decoration:none}.footer{margin-top:30px;font-size:14px;color:#ccc}.footer a:link,.footer a:visited{text-decoration:underline;color:#ccc}.footer a:hover,.footer a:active{text-decoration:none}.hidden{display:none}</style> <style>body{margin:15px 30px;line-height:1.4}kbd{font-family:inherit;background:#f0f0f0;border:1px solid #ddd;border-radius:5px;padding:0 4px}input[type=number]::-webkit-inner-spin-button{-webkit-appearance:none}.wikia-link:link,.wikia-link:visited{color:inherit;background:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAA/1BMVEX///8AAABAQEANDQ1TU1M/Pz8MDAxHR0cAAABAQEBhYWFOTk4AAABMTEwYGBhhYWFHR0dWVlYAAABLS0sYGBhOTk5VVVVUVFQ+Pj4AAAAAAABpaWloaGhmZmZiYmJnZ2f+/v6jo6Pc3Nxvb29eXl5cXFxkZGRlZWW6urptbW2pqam1tbXW1tb4+Pi2trZqamp8fHxfX1+0tLTg4OC4uLizs7P9/f1ubm5/f39wcHBbW1vd3d1ra2uoqKj5+fl+fn7Pz8+RkZGtra3t7e13d3eCgoKwsLB7e3uSkpKvr6/Y2NjZ2dl1dXXb29uqqqqkpKTi4uLk5ORjY2N4eHiLi4spHuS/AAAAG3RSTlMADasU0KsVsROo+cQPvUD3s9kMvD/B1dKoCw76qK6PAAAA6klEQVR4Xk3L1XaDQABFUQIkdfeO4m5x91Rd/v9bOkMHynnc615JpKjQESFUQQABj/xj48q4c9ss94E4Be7vjZc0z4UlSoeXwI84toEj1f463d6yN6sCZbnO2znY7T/RAjGGPW/gEXQfMllFOQ4zrdXSF3g2Yva88bsu5BjT6WSc6szCvp0sHxOOAdW+vvlXT4+OTxIDQo5dH63nlI5m6Ew5v1BVlWGHRk0ymIcpRtc30m1DUXKk0yZ5WcOFV69JvBy52njyalSR69t79FFZxlT02SvQMn/iDisIYg2UaJmZyMRyidZQZBX4C/BhL9uWDiH6AAAAAElFTkSuQmCC) no-repeat 100% 4px;background-size:10px 10px;padding-right:15px}.field{font-family:inherit;font-size:inherit}.units{border-spacing:0;margin-bottom:24px;border-left:1px solid #ddd;border-top:1px solid #ddd;margin-left:-11px;border-radius:10px;font-size:16px}.units_common{margin-bottom:12px}.units th{text-align:left;padding:1px 9px 2px;white-space:nowrap;border-bottom:1px solid #ddd;border-right:1px solid #ddd}.units thead tr:first-child th:first-child,.units_common tr:first-child td:first-child{border-top-left-radius:10px}.units thead tr:first-child th:last-child,.units_common tr:first-child td:last-child{border-top-right-radius:10px}.units td{padding:2px 9px 3px;white-space:nowrap;border-bottom:1px solid #ddd;border-right:1px solid #ddd}.units td>input{text-align:right}.units tfoot td:first-child,.units_common tr:last-child td:first-child{border-bottom-left-radius:10px}.units tfoot td:last-child,.units_common tr:last-child td:last-child{border-bottom-right-radius:10px}.units-quantity,.minor{font-size:14px}.minor{max-width:700px}.minor ul{padding:0;margin:0 0 15px;list-style:none}.minor li{padding-left:18px;position:relative}.minor li:before{content:'—';position:absolute;left:0}.minor p{margin:0 0 1px}.minor h3{font-size:14px;margin:0 0 2px}.minor__date{color:#777}.cost-elixir{background-position:100% 50%;background-image:url(data:image/png;base64,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);background-repeat:no-repeat;background-size:14px 16px;padding-right:19px}.cost-dark-elixir{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAgCAYAAAABtRhCAAAD80lEQVR42q2XS0hUYRiGc0bHGW9z8T7jjI6O10wFNTGpwETaSTFkgkLSKpLCIBiCGggKgmBaRq4El1KbNl02Ii0qioIWLVpUuFBaFBKUk56v9z34i/xzRg6OBx7O/Xv/9/u+/58zh0TkQMDmBH4QBT3gFDgM8nc/l6tICRgGSfAYvAar4C8wwBo4nbMgtiC4DF6Bn0CysAVm9iuoHF0CH4HYYMvhcFzblyC2o+AJSAMBhh1RCN63JYgtb3tfDK6CFRsCupgUFRU9Y2ZsOcQWAnNgU3NlC6fTKT6f73tpaWmbHYcR8BRIDhhwuFleXj6mC+ppPAbeAskVCIrX673H2JYOXS5XV15e3qdchRRut1sqKyuf19XVeTIEKyoqavPz819q9cqZ6urqFVXH3el0ocgP4Y4nB0pZWdkGmueCLngObNhpdQWyYXaix+ORQCAgxcXFYjXgwsJCiUQi8zh27G7/D1YCDFBSUsI6cKRsAp6TnesDAwMyOTkp4+Pj0tDQkBEDfSE1NTVvuLgrwRtZHLHDpLOzU/r6+qS5uVlQZ4Up1tvbK4lEQpaWlmR5eVmmp6eloKAgYz5WVVV9CwaDEYoFwPts7jCHpKenx3TR3t4ueMmktrZWwuGwDA8PSyqVkrW1NVlfX5dkMslMZMSJRqO/hoaG+ig4mq12HBm6S+rr6yUWi7EOEgqFuKeYeX1wcFBmZ2dlcXHRZGJiglNBj0XBf8jUGQpez+KOLzKldMmUKFd8mVDQdD0yMiJTU1MSj8elra2NDZURj7VtbW29SMHbVoLsQDaF3++nGJ0pdxQzHTc1NUljY6O0tLRQmANgRqw61dh+foaCd9VFrZVZC7a7EqQ7jpQiFCQU5yDoXk0NOtSzZSCdbLorFLyjCfKF3YLsRuWOLpQoxXisBJkNloECeraM/v5+ZsJ0eMuqfmxtjpZBKMjOpEOsiUqY8Jj3OE1Yb3PO6fEYB4JpPDdGwbMgraeULjlaLEmqYZSYgue8zrVSpZOdrQtyYJyvXFgqKegFy8BqhVBpZVCuFkwtHRGe0z3vs1mYFculsKury+ju7k7srKUYVRw3/2RJLbuVQdX0oAiPCVPO+0pMh89T8AUXGCVIl24wb9Gtqujqh5QC3NM54cLN+5aLNt/p6Oj4gdSfpI7+axHTFnBdlDVlEKIJWa5S7GQDC0FSaRCrT8F32UQZnDVhMH2u6WJwxXm64MOmC+qiR8BLIPv45TdQSzbWb6wqc8hEUI+f7YutHCTAqlVQDeWeaWaTfMF8Pc8/N1pcW9+lJ8AC+Aq29qhvGnPwMyb/I7jq3Sum3c/8MBgFN0EKPCBIXwpCCTTTcexr7MT6D9eNFIrhqHsGAAAAAElFTkSuQmCC);background-size:14px 16px}.cost-dark-elixir,.cost-gold{background-position:100% 50%;background-repeat:no-repeat;padding-right:19px}.cost-gold{background-image:url(data:image/png;base64,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);background-size:15px 16px}.like-button{color:#444;cursor:pointer;display:inline-block;padding:2px 6px;border:1px solid #999;border-radius:5px;background-color:#fcfcfc;background-image:-webkit-linear-gradient(#fcfcfc,#ececec);background-image:-o-linear-gradient(#fcfcfc,#ececec);background-image:linear-gradient(#fcfcfc,#ececec);line-height:1em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.like-button:hover{background-image:-webkit-linear-gradient(#fcfcfc,#e0e0e0);background-image:-o-linear-gradient(#fcfcfc,#e0e0e0);background-image:linear-gradient(#fcfcfc,#e0e0e0)}.like-button:active{background:#e3e3e3}.like-button_after{margin-left:5px}.like-button_lonely{margin-left:-7px;margin-right:15px}.number{text-align:right}.limit-exceeded{color:#d00}.intro{font-size:16px;max-width:800px}.result{font-weight:700}.saved-list{font-size:14px}.saved-list__item{display:inline-block;margin:0 30px 17px -13px;border:1px solid #ddd;border-radius:10px;padding:10px 13px;vertical-align:top;color:#444;line-height:1.35}.saved-list__item-title{font-weight:700;color:#222;margin-bottom:3px}.saved-list__item-title_next{margin-top:8px}.saved-list__item-title span{float:right}.saved-list__item-result{margin-top:3px}.saved-list__actions{margin-top:8px}.saved-list__table{border-spacing:0}.saved-list__table td{padding-right:8px;padding-top:0;padding-bottom:0}.saved-list__table .saved-list__level{padding-top:6px;line-height:8px}</style> </head> <body> <style> .app-version-updated { display: none; } #app_version.updated + .app-version-updated { position: absolute; top: 30px; left: -12px; border: 2px solid #900; border-radius: 10px; padding: 10px; display: block; background: #ffeeee; font-weight: bold; } </style> <p style=\"position: relative;\">Last Update: <span id=\"app_version\" class=\"updated\"></span> <span id=\"app-updated\" class=\"app-version-updated\">Version updated!</span></p> <script> document.getElementById('app-updated').ontouchend = function(e) { e.preventDefault(); e.stopPropagation(); document.getElementById('app_version').className = ''; }; </script> <table class=\"units units_common\"> <tr> <td> <label for=\"barracks-levels-1\"><a href=\"http://clashofclans.wikia.com/wiki/Barracks\" class=\"wikia-link js-link\" target=\"_blank\">Barracks</a> Levels</label> </td> <td> <select id=\"barracks-levels-1\" class=\"field\" tabindex=\"1\"> <option value=\"1\">1</option> <option value=\"2\">2</option> <option value=\"3\">3</option> <option value=\"4\">4</option> <option value=\"5\">5</option> <option value=\"6\">6</option> <option value=\"7\">7</option> <option value=\"8\">8</option> <option value=\"9\">9</option> <option value=\"10\" selected=\"selected\">10</option> </select> <select id=\"barracks-levels-2\" class=\"field\" tabindex=\"5\"> <option value=\"0\">0</option> <option value=\"1\">1</option> <option value=\"2\">2</option> <option value=\"3\">3</option> <option value=\"4\">4</option> <option value=\"5\">5</option> <option value=\"6\">6</option> <option value=\"7\">7</option> <option value=\"8\">8</option> <option value=\"9\">9</option> <option value=\"10\" selected=\"selected\">10</option> </select> <select id=\"barracks-levels-3\" class=\"field\" tabindex=\"10\"> <option value=\"0\">0</option> <option value=\"1\">1</option> <option value=\"2\">2</option> <option value=\"3\">3</option> <option value=\"4\">4</option> <option value=\"5\">5</option> <option value=\"6\">6</option> <option value=\"7\">7</option> <option value=\"8\">8</option> <option value=\"9\">9</option> <option value=\"10\" selected=\"selected\">10</option> </select> <select id=\"barracks-levels-4\" class=\"field\" tabindex=\"15\"> <option value=\"0\">0</option> <option value=\"1\">1</option> <option value=\"2\">2</option> <option value=\"3\">3</option> <option value=\"4\">4</option> <option value=\"5\">5</option> <option value=\"6\">6</option> <option value=\"7\">7</option> <option value=\"8\">8</option> <option value=\"9\">9</option> <option value=\"10\" selected=\"selected\">10</option> </select> </td> </tr> <tr> <td> <label for=\"dark-barracks-levels-1\"><a href=\"http://clashofclans.wikia.com/wiki/Dark_Barracks\" class=\"wikia-link js-link\" target=\"_blank\">Dark Barracks</a> Levels</label> </td> <td> <select id=\"dark-barracks-levels-1\" class=\"field\" tabindex=\"20\"> <option value=\"0\">0</option> <option value=\"1\">1</option> <option value=\"2\">2</option> <option value=\"3\">3</option> <option value=\"4\" selected=\"selected\">4</option> </select> <select id=\"dark-barracks-levels-2\" class=\"field\" tabindex=\"25\"> <option value=\"0\">0</option> <option value=\"1\">1</option> <option value=\"2\">2</option> <option value=\"3\">3</option> <option value=\"4\" selected=\"selected\">4</option> </select> </td> </tr> <tr> <td> <label for=\"army-camps\"><a href=\"http://clashofclans.wikia.com/wiki/Army_Camp\" class=\"wikia-link js-link\" target=\"_blank\">Army Camps</a> Capacity</label> </td> <td> <input type=\"number\" data-object-type=\"all\" step=\"5\" min=\"20\" max=\"220\" class=\"js-number field\" data-multiplier=\"5\" value=\"220\" id=\"army-camps\" size=\"3\" tabindex=\"30\"/> </td> </tr> <tr> <td> <label for=\"spell-factory-level\"><a href=\"http://clashofclans.wikia.com/wiki/Spell_Factory\" class=\"wikia-link js-link\" target=\"_blank\">Spell Factory</a> Level</label> </td> <td> <select id=\"spell-factory-level\" class=\"field\" tabindex=\"35\"> <option value=\"0\">0</option> <option value=\"1\">1</option> <option value=\"2\">2</option> <option value=\"3\">3</option> <option value=\"4\" selected=\"selected\">4</option> </select> </td> </tr> </table> <table id=\"units\" class=\"units\"> <thead> <tr> <th>Unit</th> <th>Level</th> <th>Quantity <span class=\"units-quantity\" title=\"Free Capacity\" id=\"units-quantity\"></span></th> <th><span class=\"cost-elixir\">Total</span></th> <th>Subtract</th> <th colspan=\"4\">Barracks <span class=\"limit-exceeded units-quantity\" style=\"display: none;\" id=\"units-barracks-exceeded\">(too many units)</span></th> </tr> <tr> <td colspan=\"2\"></td> <td><span class=\"like-button js-reset\" data-reset-type=\"units\" data-scope=\"quantity\">Reset</span></td> <td></td> <td><span class=\"like-button js-reset\" data-reset-type=\"units\" data-scope=\"subtract\">Reset</span></td> <td id=\"units-barrack-header-1\"></td> <td id=\"units-barrack-header-2\"></td> <td id=\"units-barrack-header-3\"></td> <td id=\"units-barrack-header-4\"></td> </tr> </thead> <tbody id=\"units-body\"> </tbody> <tfoot> <tr> <td colspan=\"2\"></td> <td id=\"units-space\" class=\"result\"></td> <td id=\"units-cost\" class=\"number result\"></td> <td></td> <td id=\"units-time-barrack-1\" class=\"number\"></td> <td id=\"units-time-barrack-2\" class=\"number\"></td> <td id=\"units-time-barrack-3\" class=\"number\"></td> <td id=\"units-time-barrack-4\" class=\"number\"></td> </tr> </tfoot> </table> <table id=\"dark\" class=\"units\"> <thead> <tr> <th>Unit</th> <th>Level</th> <th>Quantity <span class=\"units-quantity\" title=\"Free Capacity\" id=\"dark-quantity\"></span></th> <th><span class=\"cost-dark-elixir\">Total</span></th> <th>Subtract</th> <th colspan=\"2\">Dark Barracks <span class=\"limit-exceeded units-quantity\" style=\"display: none;\" id=\"dark-barracks-exceeded\">(too many units)</span></th> </tr> <tr> <td colspan=\"2\"></td> <td><span class=\"like-button js-reset\" data-reset-type=\"dark\" data-scope=\"quantity\">Reset</span></td> <td></td> <td><span class=\"like-button js-reset\" data-reset-type=\"dark\" data-scope=\"subtract\">Reset</span></td> <td id=\"dark-barrack-header-1\"></td> <td id=\"dark-barrack-header-2\"></td> </tr> </thead> <tbody id=\"dark-body\"> </tbody> <tfoot> <tr> <td colspan=\"2\"></td> <td id=\"dark-space\" class=\"result\"></td> <td id=\"dark-cost\" class=\"number result\"></td> <td></td> <td id=\"dark-time-barrack-1\" class=\"number\"></td> <td id=\"dark-time-barrack-2\" class=\"number\"></td> </tr> </tfoot> </table> <table id=\"spells\" class=\"units\"> <thead> <tr> <th>Spell</th> <th>Level</th> <th>Quantity <span class=\"units-quantity\" title=\"Free Capacity\" id=\"spells-quantity\"></span></th> <th><span class=\"cost-gold\">Total</span></th> </tr> </thead> <tbody id=\"spells-body\"> </tbody> <tfoot> <tr> <td colspan=\"2\"></td> <td class=\"result\"> <span id=\"spells-space\"></span> — <span id=\"spells-time\"></span> </td> <td id=\"spells-cost\" class=\"number result\"></td> </tr> </tfoot> </table> <p> <span id=\"save\" class=\"like-button like-button_lonely\" tabindex=\"2000\">Save Calculation</span> </p> <div id=\"saved-list\" class=\"saved-list\"> <div id=\"saved-list-content\" class=\"saved-list__content\"> </div> </div> <script>/** * @preserve Copyright 2012 Twitter, Inc. * @license http://www.apache.org/licenses/LICENSE-2.0.txt */ var Hogan={};(function(a,b){function i(a){return String(a===null||a===undefined?\"\":a)}function j(a){return a=i(a),h.test(a)?a.replace(c,\"&amp;\").replace(d,\"&lt;\").replace(e,\"&gt;\").replace(f,\"&#39;\").replace(g,\"&quot;\"):a}a.Template=function(a,c,d,e){this.r=a||this.r,this.c=d,this.options=e,this.text=c||\"\",this.buf=b?[]:\"\"},a.Template.prototype={r:function(a,b,c){return\"\"},v:j,t:i,render:function(b,c,d){return this.ri([b],c||{},d)},ri:function(a,b,c){return this.r(a,b,c)},rp:function(a,b,c,d){var e=c[a];return e?(this.c&&typeof e==\"string\"&&(e=this.c.compile(e,this.options)),e.ri(b,c,d)):\"\"},rs:function(a,b,c){var d=a[a.length-1];if(!k(d)){c(a,b,this);return}for(var e=0;e<d.length;e++)a.push(d[e]),c(a,b,this),a.pop()},s:function(a,b,c,d,e,f,g){var h;return k(a)&&a.length===0?!1:(typeof a==\"function\"&&(a=this.ls(a,b,c,d,e,f,g)),h=a===\"\"||!!a,!d&&h&&b&&b.push(typeof a==\"object\"?a:b[b.length-1]),h)},d:function(a,b,c,d){var e=a.split(\".\"),f=this.f(e[0],b,c,d),g=null;if(a===\".\"&&k(b[b.length-2]))return b[b.length-1];for(var h=1;h<e.length;h++)f&&typeof f==\"object\"&&e[h]in f?(g=f,f=f[e[h]]):f=\"\";return d&&!f?!1:(!d&&typeof f==\"function\"&&(b.push(g),f=this.lv(f,b,c),b.pop()),f)},f:function(a,b,c,d){var e=!1,f=null,g=!1;for(var h=b.length-1;h>=0;h--){f=b[h];if(f&&typeof f==\"object\"&&a in f){e=f[a],g=!0;break}}return g?(!d&&typeof e==\"function\"&&(e=this.lv(e,b,c)),e):d?!1:\"\"},ho:function(a,b,c,d,e){var f=this.c,g=this.options;g.delimiters=e;var d=a.call(b,d);return d=d==null?String(d):d.toString(),this.b(f.compile(d,g).render(b,c)),!1},b:b?function(a){this.buf.push(a)}:function(a){this.buf+=a},fl:b?function(){var a=this.buf.join(\"\");return this.buf=[],a}:function(){var a=this.buf;return this.buf=\"\",a},ls:function(a,b,c,d,e,f,g){var h=b[b.length-1],i=null;if(!d&&this.c&&a.length>0)return this.ho(a,h,c,this.text.substring(e,f),g);i=a.call(h);if(typeof i==\"function\"){if(d)return!0;if(this.c)return this.ho(i,h,c,this.text.substring(e,f),g)}return i},lv:function(a,b,c){var d=b[b.length-1],e=a.call(d);if(typeof e==\"function\"){e=i(e.call(d));if(this.c&&~e.indexOf(\"{{\"))return this.c.compile(e,this.options).render(d,c)}return i(e)}};var c=/&/g,d=/</g,e=/>/g,f=/\\'/g,g=/\\\"/g,h=/[&<>\\\"\\']/,k=Array.isArray||function(a){return Object.prototype.toString.call(a)===\"[object Array]\"}})(typeof exports!=\"undefined\"?exports:Hogan),function(a){function h(a){a.n.substr(a.n.length-1)===\"}\"&&(a.n=a.n.substring(0,a.n.length-1))}function i(a){return a.trim?a.trim():a.replace(/^\\s*|\\s*$/g,\"\")}function j(a,b,c){if(b.charAt(c)!=a.charAt(0))return!1;for(var d=1,e=a.length;d<e;d++)if(b.charAt(c+d)!=a.charAt(d))return!1;return!0}function k(a,b,c,d){var e=[],f=null,g=null;while(a.length>0){g=a.shift();if(g.tag==\"#\"||g.tag==\"^\"||l(g,d))c.push(g),g.nodes=k(a,g.tag,c,d),e.push(g);else{if(g.tag==\"/\"){if(c.length===0)throw new Error(\"Closing tag without opener: /\"+g.n);f=c.pop();if(g.n!=f.n&&!m(g.n,f.n,d))throw new Error(\"Nesting error: \"+f.n+\" vs. \"+g.n);return f.end=g.i,e}e.push(g)}}if(c.length>0)throw new Error(\"missing closing tag: \"+c.pop().n);return e}function l(a,b){for(var c=0,d=b.length;c<d;c++)if(b[c].o==a.n)return a.tag=\"#\",!0}function m(a,b,c){for(var d=0,e=c.length;d<e;d++)if(c[d].c==a&&c[d].o==b)return!0}function n(a){return a.replace(f,\"\\\\\\\\\").replace(c,'\\\\\"').replace(d,\"\\\\n\").replace(e,\"\\\\r\")}function o(a){return~a.indexOf(\".\")?\"d\":\"f\"}function p(a){var b=\"\";for(var c=0,d=a.length;c<d;c++){var e=a[c].tag;e==\"#\"?b+=q(a[c].nodes,a[c].n,o(a[c].n),a[c].i,a[c].end,a[c].otag+\" \"+a[c].ctag):e==\"^\"?b+=r(a[c].nodes,a[c].n,o(a[c].n)):e==\"<\"||e==\">\"?b+=s(a[c]):e==\"{\"||e==\"&\"?b+=t(a[c].n,o(a[c].n)):e==\"\\n\"?b+=v('\"\\\\n\"'+(a.length-1==c?\"\":\" + i\")):e==\"_v\"?b+=u(a[c].n,o(a[c].n)):e===undefined&&(b+=v('\"'+n(a[c])+'\"'))}return b}function q(a,b,c,d,e,f){return\"if(_.s(_.\"+c+'(\"'+n(b)+'\",c,p,1),'+\"c,p,0,\"+d+\",\"+e+',\"'+f+'\")){'+\"_.rs(c,p,\"+\"function(c,p,_){\"+p(a)+\"});c.pop();}\"}function r(a,b,c){return\"if(!_.s(_.\"+c+'(\"'+n(b)+'\",c,p,1),c,p,1,0,0,\"\")){'+p(a)+\"};\"}function s(a){return'_.b(_.rp(\"'+n(a.n)+'\",c,p,\"'+(a.indent||\"\")+'\"));'}function t(a,b){return\"_.b(_.t(_.\"+b+'(\"'+n(a)+'\",c,p,0)));'}function u(a,b){return\"_.b(_.v(_.\"+b+'(\"'+n(a)+'\",c,p,0)));'}function v(a){return\"_.b(\"+a+\");\"}var b=/\\S/,c=/\\\"/g,d=/\\n/g,e=/\\r/g,f=/\\\\/g,g={\"#\":1,\"^\":2,\"/\":3,\"!\":4,\">\":5,\"<\":6,\"=\":7,_v:8,\"{\":9,\"&\":10};a.scan=function(c,d){function w(){p.length>0&&(q.push(new String(p)),p=\"\")}function x(){var a=!0;for(var c=t;c<q.length;c++){a=q[c].tag&&g[q[c].tag]<g._v||!q[c].tag&&q[c].match(b)===null;if(!a)return!1}return a}function y(a,b){w();if(a&&x())for(var c=t,d;c<q.length;c++)q[c].tag||((d=q[c+1])&&d.tag==\">\"&&(d.indent=q[c].toString()),q.splice(c,1));else b||q.push({tag:\"\\n\"});r=!1,t=q.length}function z(a,b){var c=\"=\"+v,d=a.indexOf(c,b),e=i(a.substring(a.indexOf(\"=\",b)+1,d)).split(\" \");return u=e[0],v=e[1],d+c.length-1}var e=c.length,f=0,k=1,l=2,m=f,n=null,o=null,p=\"\",q=[],r=!1,s=0,t=0,u=\"{{\",v=\"}}\";d&&(d=d.split(\" \"),u=d[0],v=d[1]);for(s=0;s<e;s++)m==f?j(u,c,s)?(--s,w(),m=k):c.charAt(s)==\"\\n\"?y(r):p+=c.charAt(s):m==k?(s+=u.length-1,o=g[c.charAt(s+1)],n=o?c.charAt(s+1):\"_v\",n==\"=\"?(s=z(c,s),m=f):(o&&s++,m=l),r=s):j(v,c,s)?(q.push({tag:n,n:i(p),otag:u,ctag:v,i:n==\"/\"?r-v.length:s+u.length}),p=\"\",s+=v.length-1,m=f,n==\"{\"&&(v==\"}}\"?s++:h(q[q.length-1]))):p+=c.charAt(s);return y(r,!0),q},a.generate=function(b,c,d){var e='var _=this;_.b(i=i||\"\");'+p(b)+\"return _.fl();\";return d.asString?\"function(c,p,i){\"+e+\";}\":new a.Template(new Function(\"c\",\"p\",\"i\",e),c,a,d)},a.parse=function(a,b,c){return c=c||{},k(a,\"\",[],c.sectionTags||[])},a.cache={},a.compile=function(a,b){b=b||{};var c=a+\"||\"+!!b.asString,d=this.cache[c];return d?d:(d=this.generate(this.parse(this.scan(a,b.delimiters),a,b),a,b),this.cache[c]=d)}}(typeof exports!=\"undefined\"?exports:Hogan)</script> <script>var templates={};templates.item_row=new Hogan.Template(function(t,e,n){var a=this;return a.b(n=n||\"\"),a.b('    <tr id=\"'),a.b(a.v(a.f(\"rowId\",t,e,0))),a.b('\">'),a.b(\"\\n\"+n),a.b(\"        <td>\"),a.b(\"\\n\"+n),a.b('            <a href=\"'),a.b(a.v(a.f(\"titleLink\",t,e,0))),a.b('\" class=\"wikia-link js-link\" target=\"_blank\">'),a.b(a.v(a.f(\"title\",t,e,0))),a.b(\"</a>\"),a.b(\"\\n\"+n),a.b(\"        </td>\"),a.b(\"\\n\"+n),a.b(\"        <td>\"),a.b(\"\\n\"+n),a.b('            <select id=\"'),a.b(a.v(a.f(\"levelId\",t,e,0))),a.b('\" class=\"field\" tabindex=\"'),a.b(a.v(a.f(\"tabIndexLevel\",t,e,0))),a.b('\">'),a.b(\"\\n\"+n),a.s(a.f(\"levelContent\",t,e,1),t,e,0,271,352,\"{{ }}\")&&(a.rs(t,e,function(t,e,n){n.b('                    <option value=\"'),n.b(n.v(n.f(\"value\",t,e,0))),n.b('\">'),n.b(n.v(n.f(\"text\",t,e,0))),n.b(\"</option>\"),n.b(\"\\n\")}),t.pop()),a.b(\"            </select>\"),a.b(\"\\n\"+n),a.b(\"        </td>\"),a.b(\"\\n\"+n),a.b(\"        <td>\"),a.b(\"\\n\"+n),a.s(a.f(\"spells\",t,e,1),t,e,0,442,695,\"{{ }}\")&&(a.rs(t,e,function(t,e,a){a.b('                <select id=\"'),a.b(a.v(a.f(\"id\",t,e,0))),a.b('\" class=\"field\" tabindex=\"'),a.b(a.v(a.f(\"tabIndexValue\",t,e,0))),a.b('\">'),a.b(\"\\n\"+n),a.s(a.f(\"options\",t,e,1),t,e,0,555,644,\"{{ }}\")&&(a.rs(t,e,function(t,e,n){n.b('                        <option value=\"'),n.b(n.v(n.f(\"value\",t,e,0))),n.b('\">'),n.b(n.v(n.f(\"text\",t,e,0))),n.b(\"</option>\"),n.b(\"\\n\")}),t.pop()),a.b(\"                </select>\"),a.b(\"\\n\")}),t.pop()),a.s(a.f(\"spells\",t,e,1),t,e,1,0,0,\"\")||(a.b('                <input type=\"number\" data-object-type=\"'),a.b(a.v(a.f(\"objectType\",t,e,0))),a.b('\" min=\"0\" max=\"999\" class=\"js-number field\" id=\"'),a.b(a.v(a.f(\"id\",t,e,0))),a.b('\" size=\"3\" tabindex=\"'),a.b(a.v(a.f(\"tabIndexValue\",t,e,0))),a.b('\"/>'),a.b(\"\\n\")),a.b(\"        </td>\"),a.b(\"\\n\"+n),a.b('        <td id=\"'),a.b(a.v(a.f(\"summaryId\",t,e,0))),a.b('\" class=\"number\">'),a.b(\"\\n\"+n),a.b(\"        </td>\"),a.b(\"\\n\"+n),a.s(a.f(\"subtractId\",t,e,1),t,e,0,1018,1237,\"{{ }}\")&&(a.rs(t,e,function(t,e,a){a.b(\"            <td>\"),a.b(\"\\n\"+n),a.b('               <input type=\"number\" data-object-type=\"'),a.b(a.v(a.f(\"objectType\",t,e,0))),a.b('\" min=\"0\" max=\"999\" class=\"js-number field\" id=\"'),a.b(a.v(a.f(\"subtractId\",t,e,0))),a.b('\" size=\"3\" tabindex=\"'),a.b(a.v(a.f(\"tabIndexSubtract\",t,e,0))),a.b('\"/>'),a.b(\"\\n\"+n),a.b(\"            </td>\"),a.b(\"\\n\")}),t.pop()),a.s(a.f(\"barracksTimes\",t,e,1),t,e,0,1279,1352,\"{{ }}\")&&(a.rs(t,e,function(t,e,n){n.b('            <td id=\"'),n.b(n.v(n.f(\"barrackQuantityId\",t,e,0))),n.b('\" class=\"number\"></td>'),n.b(\"\\n\")}),t.pop()),a.b(\"    </tr>\"),a.fl()}),templates.saved_list_item=new Hogan.Template(function(t,e,n){var a=this;return a.b(n=n||\"\"),a.b('<div class=\"saved-list__item\" id=\"saved-list-item-'),a.b(a.v(a.f(\"index\",t,e,0))),a.b('\">'),a.b(\"\\n\"+n),a.s(a.f(\"hasUnits\",t,e,1),t,e,0,79,494,\"{{ }}\")&&(a.rs(t,e,function(t,e,a){a.b('        <div class=\"saved-list__item-title\"><span class=\"cost-elixir\">'),a.b(a.v(a.f(\"totalCost\",t,e,0))),a.b(\"</span>Units</div>\"),a.b(\"\\n\"+n),a.b('        <table class=\"saved-list__table\">'),a.b(\"\\n\"+n),a.s(a.f(\"units\",t,e,1),t,e,0,246,462,\"{{ }}\")&&(a.rs(t,e,function(t,e,a){a.b(\"                <tr>\"),a.b(\"\\n\"+n),a.b('                    <td class=\"number\">'),a.b(a.v(a.f(\"quantity\",t,e,0))),a.b(\"</td>\"),a.b(\"\\n\"+n),a.b(\"                    <td>\"),a.b(a.v(a.f(\"name\",t,e,0))),a.b(\"</td>\"),a.b(\"\\n\"+n),a.b('                    <td class=\"saved-list__level\">'),a.b(a.v(a.f(\"level\",t,e,0))),a.b(\"</td>\"),a.b(\"\\n\"+n),a.b(\"                </tr>\"),a.b(\"\\n\")}),t.pop()),a.b(\"        </table>\"),a.b(\"\\n\")}),t.pop()),a.b(\"\\n\"+n),a.s(a.f(\"hasDark\",t,e,1),t,e,0,525,971,\"{{ }}\")&&(a.rs(t,e,function(t,e,a){a.b('        <div class=\"saved-list__item-title saved-list__item-title_next\"><span class=\"cost-dark-elixir\">'),a.b(a.v(a.f(\"darkCost\",t,e,0))),a.b(\"</span>&nbsp;</div>\"),a.b(\"\\n\"+n),a.b('        <table class=\"saved-list__table\">'),a.b(\"\\n\"+n),a.s(a.f(\"dark\",t,e,1),t,e,0,724,940,\"{{ }}\")&&(a.rs(t,e,function(t,e,a){a.b(\"                <tr>\"),a.b(\"\\n\"+n),a.b('                    <td class=\"number\">'),a.b(a.v(a.f(\"quantity\",t,e,0))),a.b(\"</td>\"),a.b(\"\\n\"+n),a.b(\"                    <td>\"),a.b(a.v(a.f(\"name\",t,e,0))),a.b(\"</td>\"),a.b(\"\\n\"+n),a.b('                    <td class=\"saved-list__level\">'),a.b(a.v(a.f(\"level\",t,e,0))),a.b(\"</td>\"),a.b(\"\\n\"+n),a.b(\"                </tr>\"),a.b(\"\\n\")}),t.pop()),a.b(\"        </table>\"),a.b(\"\\n\")}),t.pop()),a.b(\"\\n\"+n),a.s(a.f(\"hasCapacity\",t,e,1),t,e,0,1005,1115,\"{{ }}\")&&(a.rs(t,e,function(t,e,a){a.b('        <div class=\"saved-list__item-result\">'),a.b(\"\\n\"+n),a.b(\"            \"),a.b(a.v(a.f(\"totalCapacity\",t,e,0))),a.b(\"/\"),a.b(a.v(a.f(\"armyCamps\",t,e,0))),a.b(\"\\n\"+n),a.b(\"        </div>\"),a.b(\"\\n\")}),t.pop()),a.b(\"\\n\"+n),a.s(a.f(\"hasSpells\",t,e,1),t,e,0,1151,1711,\"{{ }}\")&&(a.rs(t,e,function(t,e,a){a.b('        <div class=\"saved-list__item-title saved-list__item-title_next\"><span class=\"cost-gold\">'),a.b(a.v(a.f(\"spellsCost\",t,e,0))),a.b(\"</span>Spells</div>\"),a.b(\"\\n\"+n),a.b('        <table class=\"saved-list__table\">'),a.b(\"\\n\"+n),a.s(a.f(\"spells\",t,e,1),t,e,0,1347,1563,\"{{ }}\")&&(a.rs(t,e,function(t,e,a){a.b(\"                <tr>\"),a.b(\"\\n\"+n),a.b('                    <td class=\"number\">'),a.b(a.v(a.f(\"quantity\",t,e,0))),a.b(\"</td>\"),a.b(\"\\n\"+n),a.b(\"                    <td>\"),a.b(a.v(a.f(\"name\",t,e,0))),a.b(\"</td>\"),a.b(\"\\n\"+n),a.b('                    <td class=\"saved-list__level\">'),a.b(a.v(a.f(\"level\",t,e,0))),a.b(\"</td>\"),a.b(\"\\n\"+n),a.b(\"                </tr>\"),a.b(\"\\n\")}),t.pop()),a.b(\"        </table>\"),a.b(\"\\n\"+n),a.b('        <div class=\"saved-list__item-result\">'),a.b(\"\\n\"+n),a.b(\"            \"),a.b(a.v(a.f(\"spellsCapacity\",t,e,0))),a.b(\"/\"),a.b(a.v(a.f(\"spellsFactoryLevel\",t,e,0))),a.b(\"\\n\"+n),a.b(\"        </div>\"),a.b(\"\\n\")}),t.pop()),a.b(\"\\n\"+n),a.b('    <div class=\"saved-list__actions\">'),a.b(\"\\n\"+n),a.b('        <span class=\"like-button like-button_lonely js-saved-load\" data-num=\"'),a.b(a.v(a.f(\"index\",t,e,0))),a.b('\" tabindex=\"'),a.b(a.v(a.f(\"tabIndexLoad\",t,e,0))),a.b('\" title=\"Current calculation will be lost\">Load</span>'),a.b(\"\\n\"+n),a.b('        <span class=\"like-button like-button_lonely js-saved-delete\" data-num=\"'),a.b(a.v(a.f(\"index\",t,e,0))),a.b('\" tabindex=\"'),a.b(a.v(a.f(\"tabIndexDelete\",t,e,0))),a.b('\">Delete</span>'),a.b(\"\\n\"+n),a.b(\"    </div>\"),a.b(\"\\n\"+n),a.b(\"</div>\"),a.fl()});</script> <script>(function(window, document) { 'use strict'; var toArray = function(likeArrayObject) { var resultArray = []; var i; var l; for (i = 0, l = likeArrayObject.length; i < l; i++) { resultArray.push(likeArrayObject[i]); } return resultArray; }; if (!Function.prototype.bind) { Function.prototype.bind = function(context) { var self = this; var args = toArray(arguments).slice(1); return function() { return self.apply(context, args.concat(toArray(arguments))); }; }; } var objectIterate = function(obj, callback) { var key; for (key in obj) { if (obj.hasOwnProperty(key)) { if (callback(key, obj[key]) === false) { break; } } } }; var objectCopy = function(obj) { var newObj = obj.constructor(); objectIterate(obj, function(key, value) { newObj[key] = value; }); return newObj; }; var numberFormat = function(n) { return n.toString().replace(/(\\d)(?=(\\d\\d\\d)+(?!\\d))/g, '$1,'); }; var convertToTitle = function(s) { return s.replace('_', ' ').replace(/-/g, '.'); }; var getWikiaLink = function(s, isSpell) { return 'http://clashofclans.wikia.com/wiki/' + s.replace(' ', '_') + (isSpell ? '_Spell' : ''); }; var getFormattedTime = function(time, hideSeconds) { var formattedTime = ''; var remainingTime = time; if (remainingTime > 3599) { formattedTime += Math.floor(remainingTime / 3600) + 'h '; remainingTime %= 3600; } if (remainingTime > 59) { var minutes = Math.floor(remainingTime / 60); remainingTime %= 60; if (hideSeconds && remainingTime > 0) { minutes++; } formattedTime += minutes + 'm '; } else { formattedTime += '0m '; } if (formattedTime === '' || !hideSeconds) { formattedTime += remainingTime + 's'; } return formattedTime; }; var DataStorage = function(key, defaultData) { this.key = key; this.defaultData = defaultData; this.load = function() { var data = window.localStorage.getItem(this.key); return (data && JSON.parse(data)) || this.defaultData; }; this.save = function(data) { window.localStorage.setItem(this.key, JSON.stringify(data)); }; }; var Dict = function(data) { this.data = data; this.get = function(key, defaultValue) { var value = this.data[key]; if (defaultValue !== undefined && value === undefined) { return defaultValue; } return value; }; this.set = function(key, value) { this.data[key] = value; }; this.getAll = function() { return this.data; }; }; var MultiDict = function(entries) { this.entries = []; this.retrieve = function(i) { return this.entries[i]; }; this.insert = function(data) { this.entries.push(new Dict(data)); }; this.remove = function(i) { this.entries.splice(i, 1); }; this.getAll = function() { return this.entries.map(function(entry) { return entry.getAll(); }); }; this.forEach = function(callback) { this.entries.forEach(callback); }; entries.forEach(this.insert.bind(this)); }; var IdsCacher = function() { this.elements = {}; this.get = function(id) { if (!this.elements.hasOwnProperty(id)) { this.elements[id] = document.getElementById(id); } return this.elements[id]; }; }; var ids = new IdsCacher(); var savedDataStorage = new DataStorage('savedData', {}); var savedData = new Dict(savedDataStorage.load()); var BarracksContainer = function(maxCount, selectName, saveName, queueLengths) { this.barracks = []; this.maxCount = maxCount; this.saveName = saveName; this.queueLengths = queueLengths; var i; for (i = 1; i <= this.maxCount; i++) { var barrack = ids.get(selectName + '-' + i); this.barracks.push(barrack); } this.setDefaults = function() { var saved = savedData.get(this.saveName); if (saved) { this.barracks.forEach(function(el, i) { el.options[saved[i]].selected = true; }); } }; this.updateSavedData = function() { savedData.set(this.saveName, this.barracks.map(function(el) { return el.selectedIndex; })); }; this.getMaxLevel = function() { return Math.max.apply(null, this.barracks.map(function(el) { return parseInt(el.value, 10); })); }; this.getAllNormalized = function() { return this.barracks.map(function(el) { return { 'id': el.getAttribute('id'), 'level': el.value, 'queueLength': this.queueLengths[el.value] }; }, this); }; this.getElements = function() { return this.barracks; }; this.getMaxCount = function() { return this.maxCount; }; this.getCapLevel = function() { return this.barracks[0].options[this.barracks[0].options.length - 1].value; }; this.getActiveCount = function() { return this.barracks.filter(function(b){ return b.value > 0; }).length; }; }; var allBarracks = { 'units': new BarracksContainer( 4, 'barracks-levels', 'barracksLevels', [0, 20, 25, 30, 35, 40, 45, 50, 55, 60, 75] ), 'dark': new BarracksContainer( 2, 'dark-barracks-levels', 'darkBarracksLevels', [0, 40, 50, 60, 70] ) }; var armyCamps = ids.get('army-camps'); var spellFactoryLevel = ids.get('spell-factory-level'); var types = { 'units': { 'Barbarian': [20, [25, 40, 60, 80, 100, 150], 1, 1], 'Archer': [25, [50, 80, 120, 160, 200, 300], 1, 2], 'Goblin': [30, [25, 40, 60, 80, 100], 1, 3], 'Giant': [120, [500, 1000, 1500, 2000, 2500, 3000], 5, 4], 'Wall_Breaker': [120, [1000, 1500, 2000, 2500, 3000], 2, 5], 'Balloon': [600, [2000, 2500, 3000, 3500, 4000, 4500], 5, 6], 'Wizard': [600, [1500, 2000, 2500, 3000, 3500], 4, 7], 'Healer': [1200, [7000, 10000, 13000], 20, 8], 'Dragon': [1800, [25000, 30000, 36000], 20, 9], 'P-E-K-K-A-': [2700, [30000, 35000, 42000], 25, 10] }, 'spells': { 'Lightning': [1800, [15000, 16500, 18000, 20000, 22000], 1, 1], 'Healing': [1800, [20000, 22000, 24000, 26500, 29000], 1, 2], 'Rage': [2700, [30000, 33000, 36000, 40000, 44000], 1, 3], 'Jump': [2700, [30000, 38000], 1, 4] }, 'dark': { 'Minion': [45, [6, 7, 8, 9, 10], 2, 1], 'Hog Rider': [300, [30, 35, 40, 45, 50], 6, 2], 'Valkyrie': [900, [100, 120, 140, 160], 8, 3], 'Golem': [2700, [450, 500, 550, 600], 30, 4] } }; var currentSpace = { 'units': 0, 'dark': 0 }; var setQuantityAndSpace = function(maxSpace, totalSpace, type) { var spaceDiff = maxSpace - totalSpace; if (spaceDiff < 0) { spaceDiff = '<span class=\"limit-exceeded\">' + spaceDiff + '</span>'; } ids.get(type + '-quantity').innerHTML = '(' + spaceDiff + ')'; var space = totalSpace; if (totalSpace > maxSpace) { space = '<span class=\"limit-exceeded\">' + totalSpace + '</span>'; } space = space + ' / ' + maxSpace; ids.get(type + '-space').innerHTML = space; }; var suitableBarracksSort = function(a, b) { // least time first if (a.time < b.time) { return -1; } if (a.time > b.time) { return 1; } // least space first if (a.space < b.space) { return -1; } if (a.space > b.space) { return 1; } // least max space first if (a.maxSpace < b.maxSpace) { return -1; } if (a.maxSpace > b.maxSpace) { return 1; } return 0; }; var getSuitableBarrack = function(barracks, requiredLevel, requiredSpace) { var suitable = barracks.filter(function(barrack) { return barrack.level >= requiredLevel && (barrack.space + requiredSpace) <= barrack.maxSpace; }); if (!suitable.length) { return null; } if (suitable.length > 1) { suitable.sort(suitableBarracksSort); } return suitable[0]; }; var unitsDistributionSort = function(a, b) { if (a.time < b.time) { return 1; } if (a.time > b.time) { return -1; } if (a.quantity < b.quantity) { return 1; } if (a.quantity > b.quantity) { return -1; } if (a.level < b.level) { return 1; } if (a.level > b.level) { return -1; } return 0; }; var fillBarracks = function(barracksQueue, unitsDistribution, avgTime) { var stopDistribution = false; var udIndex; var udLength; for (udIndex = 0, udLength = unitsDistribution.length; udIndex < udLength; udIndex++) { var kit = unitsDistribution[udIndex]; var i; var barrack = null; for (i = 0; i < kit.quantity; i++) { var isGetBarrack = true; if (barrack) { var newTime = barrack.time + kit.time; var newSpace = barrack.space + kit.space; if (newTime < (avgTime / 3) || newSpace < (barrack.maxSpace / 4) || (kit.space === 1 && newTime < avgTime && newSpace < barrack.maxSpace)) { isGetBarrack = false; } } if (isGetBarrack) { barrack = getSuitableBarrack(barracksQueue, kit.level, kit.space); } if (barrack === null) { stopDistribution = true; break; } if (!barrack.units[kit.name]) { barrack.units[kit.name] = 0; } barrack.units[kit.name]++; barrack.time += kit.time; barrack.space += kit.space; } } return !stopDistribution; }; var calculateItems = function(type, params) { ids.get(type).style.display = (params.levelValue === 0 ? 'none' : ''); var i; for ( i = params.capLevel; i >= 1; i-- ) { ids.get(type + '-building-level-' + i).style.display = (i > params.levelValue ? 'none' : ''); } var totalCost = 0; var totalSpace = 0; var totalTime = 0; var distribution = []; objectIterate(types[type], function(name, value) { if (value[3] > params.levelValue) { return; } var item = ids.get(name); var quantity = parseInt(item.value, 10) || 0; if (quantity < 0) { quantity = 0; } if (item.value !== '') { item.value = quantity; } var levelId = name + '-level'; var levelEl = ids.get(levelId); var summaryEl = ids.get(name + '-summary'); var costPerItem = levelEl.value; var summaryCost = (costPerItem * quantity); summaryEl.innerHTML = (summaryCost ? numberFormat(summaryCost) : 0); totalCost += summaryCost; totalSpace += (value[2] * quantity); totalTime += (value[0] * quantity); if (type !== 'spells') { var i; for (i = 1; i <= allBarracks[type].getMaxCount(); i++) { ids.get('quantity-' + name + '-' + i).innerHTML = ''; } var subtractId = name + '-subtract'; var subtract = ids.get(subtractId); var subtractQuantity = parseInt(subtract.value, 10) || 0; if (subtractQuantity < 0) { subtractQuantity = 0; } if (subtract.value !== '') { subtract.value = subtractQuantity; } if (quantity > 0) { distribution.push({ 'name': name, 'quantity': quantity - subtractQuantity, 'level': value[3], 'space': value[2], 'time': value[0], }); } savedData.set(subtractId, subtractQuantity); } savedData.set(name, quantity); savedData.set(levelId, levelEl.selectedIndex); }); if (type === 'units' || type === 'dark') { distribution.sort(unitsDistributionSort); var barracksQueue = []; allBarracks[type].getAllNormalized().forEach(function(barrackData, barrackIndex) { var header; if (parseInt(barrackData.level, 10) === 0) { header = ''; } else { header = barrackData.level + ' lvl <span class=\"' + type + '-quantity\" title=\"Maximum Unit Queue Length\">(' + barrackData.queueLength + ')</span>'; } ids.get(type + '-barrack-header-' + (barrackIndex + 1)).innerHTML = header; barracksQueue.push({ 'num': barrackIndex + 1, 'time': 0, 'space': 0, 'maxSpace': barrackData.queueLength, 'units': {}, 'level': barrackData.level }); }); var maxUnitTime = Math.max.apply(null, distribution.map(function(distributionItem) { return distributionItem.time; })); var avgTime = Math.max(Math.ceil(totalTime / allBarracks[type].getActiveCount()), maxUnitTime); var fillSuccess = fillBarracks(barracksQueue, distribution, avgTime); if (fillSuccess) { ids.get(type + '-barracks-exceeded').style.display = 'none'; var maxTime = 0; var maxNum = 1; barracksQueue.forEach(function(v) { objectIterate(v.units, function(unitName, unitQuantity) { if (unitQuantity > 0) { ids.get('quantity-' + unitName + '-' + v.num).innerHTML = '×' + unitQuantity; } }); if (v.time > maxTime) { maxTime = v.time; maxNum = v.num; } ids.get(type + '-time-barrack-' + v.num).innerHTML = (v.time ? getFormattedTime(v.time) : ''); }); var maxBarrack = ids.get(type + '-time-barrack-' + maxNum); maxBarrack.innerHTML = '<span class=\"result\">' + maxBarrack.innerHTML + '</span>'; } else { ids.get(type + '-barracks-exceeded').style.display = ''; barracksQueue.forEach(function(v) { ids.get(type + '-time-barrack-' + v.num).innerHTML = ''; }); } currentSpace[type] += totalSpace; } ids.get(type + '-cost').innerHTML = numberFormat(totalCost); if (type === 'spells') { setQuantityAndSpace(params.space, totalSpace, type); ids.get(type + '-time').innerHTML = getFormattedTime(totalTime, true); } }; var calculateDelayedTimeoutLong = null; var calculateDelayedTimeoutShort = null; var calculateDelayed = function(type) { var calculateFunc = calculate.bind(null, type); if (!calculateDelayedTimeoutLong) { calculateDelayedTimeoutLong = setTimeout(calculateFunc, 500); } clearTimeout(calculateDelayedTimeoutShort); calculateDelayedTimeoutShort = setTimeout(calculateFunc, 150); }; var calculate = function(type) { clearTimeout(calculateDelayedTimeoutLong); clearTimeout(calculateDelayedTimeoutShort); calculateDelayedTimeoutLong = null; if (type === 'all' || type !== 'spells') { var armyCampsSpace = parseInt(armyCamps.value, 10); if (isNaN(armyCampsSpace) || armyCampsSpace < 0) { armyCampsSpace = 0; } var armyCampsMaxSpace = armyCamps.getAttribute('max'); if (armyCampsSpace > armyCampsMaxSpace) { armyCampsSpace = armyCampsMaxSpace; } armyCamps.value = armyCampsSpace; if (type === 'all' || type === 'units') { currentSpace.units = 0; calculateItems('units', { 'levelValue': allBarracks.units.getMaxLevel(), 'space': armyCampsSpace, 'capLevel': allBarracks.units.getCapLevel() }); } if (type === 'all' || type === 'dark') { currentSpace.dark = 0; calculateItems('dark', { 'levelValue': allBarracks.dark.getMaxLevel(), 'space': armyCampsSpace, 'capLevel': allBarracks.dark.getCapLevel() }); } var togetherSpace = currentSpace.units + currentSpace.dark; setQuantityAndSpace(armyCamps.value, togetherSpace, 'units'); setQuantityAndSpace(armyCamps.value, togetherSpace, 'dark'); savedData.set('armyCamps', armyCamps.value); allBarracks.units.updateSavedData(); allBarracks.dark.updateSavedData(); } if (type === 'all' || type === 'spells') { calculateItems('spells', { 'levelValue': parseInt(spellFactoryLevel.value, 10), 'space': spellFactoryLevel.value, 'capLevel': spellFactoryLevel.options[spellFactoryLevel.options.length - 1].value }); savedData.set('spellFactoryLevel', spellFactoryLevel.selectedIndex); } savedDataStorage.save(savedData.getAll()); }; var setDefaults = function() { allBarracks.units.setDefaults(); allBarracks.dark.setDefaults(); armyCamps.value = savedData.get('armyCamps', armyCamps.value); spellFactoryLevel.options[savedData.get('spellFactoryLevel', spellFactoryLevel.selectedIndex)].selected = true; var setItems = function(type) { objectIterate(types[type], function(name) { var levelId = name + '-level'; var levelEl = ids.get(levelId); levelEl.options[savedData.get(levelId, levelEl.selectedIndex)].selected = true; var valueEl = ids.get(name); if (type === 'spells') { valueEl.options[savedData.get(name, valueEl.selectedIndex)].selected = true; } else { valueEl.value = savedData.get(name) || 0; var subtractId = name + '-subtract'; ids.get(subtractId).value = savedData.get(subtractId) || 0; } }); }; setItems('units'); setItems('spells'); setItems('dark'); }; objectIterate(allBarracks, function(k, v) { v.getElements().forEach(function(el) { el.addEventListener('change', calculate.bind(null, k), false); }); }); armyCamps.addEventListener('input', calculate.bind(null, 'all'), false); spellFactoryLevel.addEventListener('change', calculate.bind(null, 'spells'), false); var spinnerAction = function(eventElement) { var targetElement = ids.get(eventElement.getAttribute('data-target')); var multiplier = parseInt(targetElement.getAttribute('data-multiplier'), 10) || 1; var current = parseInt(targetElement.value, 10); if (eventElement.getAttribute('data-spinner-type') === 'plus') { if (isNaN(current)) { targetElement.value = multiplier; } else { targetElement.value = current + multiplier; } } else { if (isNaN(current) || current < 2) { targetElement.value = 0; } else { targetElement.value = current - multiplier; } } calculateDelayed(targetElement.getAttribute('data-object-type')); }; var setSpinner = function(type, el) { var span = document.createElement('span'); span.className = 'like-button like-button_after'; span.innerHTML = (type === 'plus' ? '+' : '−'); span.setAttribute('data-spinner-type', type); span.setAttribute('data-target', el.getAttribute('id')); var interval = null; var timeout = null; var hold = function(e) { e.preventDefault(); e.stopPropagation(); e.target.setAttribute('data-clicked', '1'); timeout = window.setTimeout(function(eventElement) { eventElement.removeAttribute('data-clicked'); interval = window.setInterval( spinnerAction.bind(null, eventElement), 100 ); }.bind(null, e.target), 500); }; var release = function(e) { e.preventDefault(); e.stopPropagation(); if (e.target.getAttribute('data-clicked') === '1') { spinnerAction(e.target); } clearTimeout(timeout); clearInterval(interval); }; span.addEventListener('touchstart', hold); span.addEventListener('touchend', release); span.addEventListener('mousedown', hold); span.addEventListener('mouseup', release); el.parentNode.appendChild(span); }; var rowTemplate = templates.item_row; var createRows = function(type, tabIndexMultiplier) { var createLevelOption = function(value, index) { return {'value': value, 'text': (index + 1)}; }; var spellsValuesContent = []; if (type === 'spells') { var i; for (i = 0; i < 5; i++) { spellsValuesContent.push({'value': i, 'text': i}); } } var itemsBody = ids.get(type + '-body'); objectIterate(types[type], function(name, value) { var convertedName = convertToTitle(name); var templateVars = { 'id': name, 'title': convertedName, 'titleLink': getWikiaLink(convertedName, (type === 'spells')), 'levelId': name + '-level', 'levelContent': value[1].map(createLevelOption), 'summaryId': name + '-summary', 'rowId': type + '-building-level-' + value[3], 'tabIndexLevel': tabIndexMultiplier + value[3], 'tabIndexValue': tabIndexMultiplier + 1000 + value[3], 'objectType': type }; if (type === 'spells') { templateVars.spells = { 'options': spellsValuesContent }; } if (type === 'units' || type === 'dark') { var i; var barracksTimes = []; for (i = 1; i <= allBarracks[type].getMaxCount(); i++) { barracksTimes.push({ 'barrackQuantityId': 'quantity-' + name + '-' + i }); } templateVars.barracksTimes = barracksTimes; templateVars.subtractId = name + '-subtract'; templateVars.tabIndexSubtract = tabIndexMultiplier + 4000 + value[3]; } var rowHTML = rowTemplate.render(templateVars); var tempDiv = document.createElement('div'); tempDiv.innerHTML = '<table>' + rowHTML + '</table>'; var itemRow = tempDiv.querySelector('tr'); itemsBody.appendChild(itemRow); ids.get(templateVars.levelId).addEventListener('change', calculate.bind(null, type), false); ids.get(templateVars.id).addEventListener( (type === 'spells' ? 'change' : 'input'), calculate.bind(null, type), false ); if (type === 'units' || type === 'dark') { ids.get(templateVars.subtractId).addEventListener('input', calculate.bind(null, type), false); } }); }; createRows('units', 100); createRows('dark', 200); createRows('spells', 300); var selectAll = function(e) { if (e.target.tagName.toLowerCase() === 'input') { setTimeout(function(el) { el.setSelectionRange(0, 9999); }.bind(null, e.target), 10); } }; toArray(document.getElementsByClassName('js-number')).forEach(function(el) { el.addEventListener('focus', selectAll, false); setSpinner('plus', el); setSpinner('minus', el); }); var resetColumn = function(e) { e.preventDefault(); e.stopPropagation(); var resetType = e.target.getAttribute('data-reset-type'); objectIterate(types[resetType], function(k) { var key = k; var scope = e.target.getAttribute('data-scope'); if (scope !== 'quantity') { key += '-' + scope; } ids.get(key).value = '0'; }); calculate(resetType); }; toArray(document.getElementsByClassName('js-reset')).forEach(function(el) { el.addEventListener('click', resetColumn, false); el.addEventListener('touchend', resetColumn, false); }); setDefaults(); calculate('all'); if (window.device && window.device.cordova) { toArray(document.getElementsByClassName('js-link')).forEach(function(el) { var href = el.getAttribute('href'); el.removeAttribute('target'); el.setAttribute('href', 'javascript:void(0)'); el.addEventListener('touchend', function(e) { e.preventDefault(); e.stopPropagation(); app.open_browser(href); }); }); } var savedCalculationsStorage = new DataStorage('savedCalculations', []); var savedCalculations = new MultiDict(savedCalculationsStorage.load()); var savedListItemTemplate = templates.saved_list_item; var savedListCreateItems = function() { var content = []; savedCalculations.forEach(function(data, index) { var templateVars = { 'index': index, 'tabIndexLoad': index + 3000 + 1, 'tabIndexDelete': index + 3000 + 2 }; var unitsItems = []; var totalCost = 0; var totalCapacity = 0; var barracksLevels = data.get('barracksLevels', [10, 10, 10, 10]); objectIterate(types.units, function(name, unitValue) { var quantity = parseInt(data.get(name), 10) || 0; var barracksLevel = Math.max.apply(null, barracksLevels.map(function(barrackIndex, arrayIndex) { return (arrayIndex === 0 ? barrackIndex + 1 : barrackIndex); })); if (quantity > 0 && unitValue[3] <= barracksLevel) { unitsItems.push({ 'name': convertToTitle(name), 'level': (new Array(data.get(name + '-level') + 2)).join('*'), 'quantity': quantity }); totalCost += unitValue[1][data.get(name + '-level')] * quantity; totalCapacity += unitValue[2] * quantity; } }); if (unitsItems.length) { templateVars.hasUnits = { 'units': unitsItems, 'totalCost': numberFormat(totalCost) }; } var darkBarracksLevels = data.get('darkBarracksLevels', [4, 4]); var darkBarracksLevel = Math.max.apply(null, darkBarracksLevels); if (darkBarracksLevel > 0) { var darkItems = []; var darkCost = 0; objectIterate(types.dark, function(name, unitValue) { var quantity = parseInt(data.get(name), 10) || 0; if (quantity > 0 && unitValue[3] <= darkBarracksLevel) { darkItems.push({ 'name': convertToTitle(name), 'level': (new Array(data.get(name + '-level') + 2)).join('*'), 'quantity': quantity }); darkCost += unitValue[1][data.get(name + '-level')] * quantity; totalCapacity += unitValue[2] * quantity; } }); if (darkItems.length) { templateVars.hasDark = { 'dark': darkItems, 'darkCost': numberFormat(darkCost) }; } } if (totalCapacity > 0) { templateVars.hasCapacity = { 'totalCapacity': totalCapacity, 'armyCamps': data.get('armyCamps') }; } if (data.get('spellFactoryLevel') > 0) { var spellsItems = []; var spellsCost = 0; var spellsCapacity = 0; objectIterate(types.spells, function(spellName, spellValue) { var spellQuantity = parseInt(data.get(spellName), 10) || 0; if (spellQuantity > 0 && spellValue[3] <= data.get('spellFactoryLevel')) { spellsItems.push({ 'name': convertToTitle(spellName), 'level': (new Array(data.get(spellName + '-level') + 2)).join('*'), 'quantity': spellQuantity }); spellsCost += spellValue[1][data.get(spellName + '-level')] * spellQuantity; spellsCapacity += spellValue[2] * spellQuantity; } }); if (spellsItems.length) { templateVars.hasSpells = { 'spells': spellsItems, 'spellsCost': numberFormat(spellsCost), 'spellsCapacity': spellsCapacity, 'spellsFactoryLevel': data.get('spellFactoryLevel') }; } } content.push(savedListItemTemplate.render(templateVars)); }); var savedListContent = ids.get('saved-list-content'); savedListContent.innerHTML = content.join(''); var loadSaved = function(e) { e.preventDefault(); e.stopPropagation(); savedData = new Dict(objectCopy(savedCalculations.retrieve(e.target.getAttribute('data-num')).getAll())); setDefaults(); calculate('all'); savedListCreateItems(); }; toArray(savedListContent.getElementsByClassName('js-saved-load')).forEach(function(el) { el.addEventListener('click', loadSaved, false); el.addEventListener('touchend', loadSaved, false); }); var deleteSaved = function(e) { e.preventDefault(); e.stopPropagation(); savedCalculations.remove(e.target.getAttribute('data-num')); savedCalculationsStorage.save(savedCalculations.getAll()); savedListCreateItems(); }; toArray(savedListContent.getElementsByClassName('js-saved-delete')).forEach(function(el) { el.addEventListener('click', deleteSaved, false); el.addEventListener('touchend', deleteSaved, false); }); }; var save = function(e) { e.preventDefault(); e.stopPropagation(); var dataToSave = objectCopy(savedData.getAll()); objectIterate(dataToSave, function(k) { if (k.indexOf('subtract') !== -1) { delete dataToSave[k]; } }); savedCalculations.insert(dataToSave); savedCalculationsStorage.save(savedCalculations.getAll()); savedListCreateItems(); }; ids.get('save').addEventListener('click', save, false); ids.get('save').addEventListener('touchend', save, false); savedListCreateItems(); }(window, document)); </script> </body> </html> ","version":1367660161619},"changelog":{"1367179200000":["The maximum value of Army Camps Capacity limited to 220"],"1366833600000":["Dramatically increased performance, especially on iPhone/iPad"],"1366488000000":["Removed “Cost” column","Removed background highlighting on table rows","Removed help link for subtract","Form controls optimized for touch-devices","Wikia links","Fixed a bug in which a long press on the plus/minus led to the selection of the text","Reduced internal indent in the tables"],"1366142400000":["Dark Barracks max level increased to 4","Added Golem to Dark Barracks","Production time for spells decreased: Lighting/Healing — 30m, Rage/Jump — 45m"],"1366056000000":["Added reset buttons","New appearance for buttons"],"1365883200000":["Added awesome feature to “subtract” units, which you already have. For example, you want to get 100 Barbarians and 100 Archers. And you already have 20 Barbarians. In the column “Quantity”, as usual, make 100 Barbarians and 100 Archers. And in the column “Subtract” 20 Barbarians. Now the distribution between the barracks are considered to be only for 80 Barbarians and 100 Archers. This is very useful, when after the battle you have remained part of the army"],"1365710400000":["The correct order for keyboard navigation through <kbd>TAB</kbd> key","Production time for each unit separately are no longer displayed (useless information)"],"1365624000000":["Added lovely icon for iOS “Add to Home Screen” feature","New favicon for easy identification of the site among many open tabs","Retina graphics","Internal optimizations for better performance"],"1365364800000":["Dark Barracks troops distribution","Removed embedded font, font changed to PT Sans/Helvetica Neue/Arial, it greatly reduced the speed of page loading","Army camps capacity increment/decrement in five points"],"1363118400000":["Dark Barracks troops calculation"],"1363032000000":["Wall Breaker capacity increased from 1 to 2","P.E.K.K.A. training time reduced from 1 hour to 45 minutes","P.E.K.K.A. and Dragon costs reduced"],"1362427200000":["Fixed a bug in which the units were distributed in barracks without accounting maximum barracks queue","Fixed bug with negative number of units"],"1361995200000":["Added distribution of troops between barracks for optimal training speed","The previous values of the maximum level and number of barracks, unfortunately, have not saved","Production Time removed from saved calculations list","Simplified tables layouts"],"1361822400000":["Reduced indents and font sizes","The list of saved calculations is always shown","Redesigned saved calculations layout"],"1361044800000":["Added saving of calculations"],"1360440000000":["Added description of the calculator","Default values changed to maximum allowed in game"],"1360353600000":["Added auto-select of text in fields for simplify edit in iOS","Fixed NaN in results and null in fields bug"],"1360267200000":["The title is replaced by the more similar to the contents of the page","Added description for auto-save feature","Added army camps capacity — allows to show free capacity","Added maximum barracks level — allows show/hide unavailable units","Added spells calculation"],"1360094400000":["Added plus/minus buttons","Fixed IE 9+ support","Changed favicon to app store game icon","Added elixir icon to costs","Added intermediate results of the calculations to the units table"],"1360008000000":["Added sixth level for Barbarian, Archer, Giant and Balloon","Fixed Healer 1st level cost","Number of barracks field replaced by the select"],"1359921600000":["Initial release"]}},"error":0}